<!DOCTYPE HTML>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <title>IPSAA</title>
</head>
<body>
</body>
</html>

<script type="text/javascript">

    redirect();

    function redirect() {
        var token = localStorage.getItem("ngStorage-token");
        if (token) {
            var parts = token.split('.');
            var decoded = urlBase64Decode(parts[1]);
            var decodedObj = JSON.parse(decoded);
            window.location.href = decodedObj.domain + "index.html";
            return;
        }
        window.location.href = "/pp/index.html";
    }

    function urlBase64Decode(str) {
        var output = str.replace(/-/g, '+').replace(/_/g, '/');
        switch (output.length % 4) {
            case 0: {
                break;
            }
            case 2: {
                output += '==';
                break;
            }
            case 3: {
                output += '=';
                break;
            }
            default: {
                throw 'Illegal base64url string!';
            }
        }
        return window.decodeURIComponent(escape(window.atob(output))); //polyfill https://github.com/davidchambers/Base64.js
    }
</script>